#########################################
# Fragments
#########################################
fragment PortfolioSummary on Portfolio {
      cash
      private
      owner
      name
      description
}
fragment SymbolSummary on Symbol {
  symbol
  securityName
  exchange
  country
}

fragment FullPosition on Position {
  profitLossPercent
  profitLossUsd
  dailyProfitLossUsd
  averagePrice
  costBasis
  numberOfShares
  exposure
  marketValue
  symbol {
    _id
    ...SymbolSummary
      quote {
        _id
        latestPrice
        changePercent
      }
  }
}

fragment AllPageInfo on PaginationInfo {
  currentPage
  perPage
  pageCount
  itemCount
  hasNextPage
  hasPreviousPage
}

#########################################
# Portfolios
#########################################
query myPortfolios {
  myPortfolios {
      _id
      ...PortfolioSummary
      positions {
        items {
          _id
          ...FullPosition
        }
        count
        pageInfo {
          ...AllPageInfo
        }
      }
  }
}

query myPortfoliosSummary {
  myPortfolios {
    _id
    ...PortfolioSummary
  }
}

query getPortfolioSummaryById($id: MongoID!) {
  getPortfolioById(_id: $id) {
    _id
    ...PortfolioSummary
  }
}

query getPortfolioById ($id: MongoID!){
  getPortfolioById(_id: $id) {
    _id
    ...PortfolioSummary
    positions {
      items {
        _id
        ...FullPosition
        
      }
    }
  }
}

#########################################
# Positions
#########################################
query getPositions($filter: PositionsFilter, $sort: PositionsSort, $perPage: Int, $page: Int) {
  getPositions(filter: $filter, sort: $sort, perPage: $perPage, page: $page) {
    items {
      _id
      ...FullPosition

    }
    count
  }
}

#########################################
# Symbols
#########################################

query searchSymbols($search: String!) {
  searchSymbols(search: $search) {
    _id
    ...SymbolSummary
  }
}